<!DOCTYPE html>
<html>
<head>
  <title>My Maps with Routes, Labels & Show Location</title>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Leaflet CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <style>
    #map { height: 100vh; }
    .route-btn {
      background-color: #4CAF50;
      color: white;
      padding: 5px 10px;
      border: none;
      border-radius: 3px;
      cursor: pointer;
      font-size: 12px;
    }
    .route-btn:hover {
      background-color: #45a049;
    }
    .leaflet-tooltip {
      background: rgba(255, 255, 255, 0.8);
      border: 1px solid #999;
      padding: 2px 6px;
      border-radius: 3px;
      font-size: 12px;
    }
    .leaflet-control-locate {
      background: white;
      border: 2px solid #ccc;
      padding: 4px 6px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 12px;
      font-weight: bold;
    }
    .leaflet-control-locate:hover {
      background: #f0f0f0;
    }
  </style>
</head>
<body>

<div id="map"></div>

<!-- Leaflet JS -->
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<script>
  var orsApiKey = "eyJvcmciOiI1YjNjZTM1OTc4NTExMTAwMDFjZjYyNDgiLCJpZCI6Ijk4Yjg4N2QwMjFmMjQ4OWRiZDA5NWQ1Zjk4MWMwNTBkIiwiaCI6Im11cm11cjY0In0=";

  var map = L.map('map').setView([-2.5, 118], 5);

  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '¬© OpenStreetMap contributors'
  }).addTo(map);

  var destinations = [
  { name: "D.I. Alue Peudeung", lat: 4.905598, lon: 97.077673 },
  { name: "D.I.R. Tanjung Sejaro", lat: -2.968142, lon: 104.730910 },
  { name: "D.I.R. Parebok", lat: -2.957959, lon: 112.927810 },
  { name: "D.I.R. Kuala Jelai", lat: -2.954167, lon: 110.761667 },
  { name: "D.I. Paluh Manan", lat: 3.751160, lon: 98.577830 },
  { name: "D.I. Kolam", lat: 3.627310, lon: 98.787920 },
  { name: "D.I. Bukit Setia", lat: 3.942270, lon: 98.459000 },
  { name: "D.I. Kerpei", lat: 3.610640, lon: 98.385250 },
  { name: "D.I. Pardomuan Nauli", lat: 3.670360, lon: 98.395480 },
  { name: "D.I. Tanjung Keriahan", lat: 3.577778, lon: 98.344320 },
  { name: "D.I.R. Gebang", lat: 3.979200, lon: 98.356900 },
  { name: "D.I. Paya Tampak", lat: 3.867900, lon: 98.482000 },
  { name: "D.I. Modo", lat: 1.447000, lon: 97.462700 },
  { name: "D.I. Zumuzu", lat: 0.945520, lon: 97.869300 },
  { name: "D.I. Sorkam Kanan", lat: 1.895830, lon: 98.572403 },
  { name: "D.I. Sogawu", lat: 1.448050, lon: 97.468518 },
  { name: "D.I. Aran Dalu", lat: 3.711865, lon: 98.584492 },
  { name: "D.I.R. Sisir Gunting", lat: 3.801718, lon: 98.615082 },
  { name: "D.I. Kota Datar", lat: 3.746665, lon: 98.548390 },
  { name: "D.I. Amplas", lat: 3.556636, lon: 98.757803 },
  { name: "D.I. Kota Rantang", lat: 3.727766, lon: 98.565113 },
  { name: "D.I.R. Pudak", lat: -1.550833, lon: 103.671944 },
  { name: "D.I. Cubo/Trienggadeng", lat: 5.196372, lon: 96.075102 },
  { name: "D.I.R. Sei Duren", lat: -1.602181, lon: 103.548024 },
  { name: "D.I. Beuracan", lat: 5.214148, lon: 96.221570 },
  { name: "D.I. Tanah Merah", lat: -0.424567, lon: 117.220424 },
  { name: "D.I.R. Betara", lat: 1.092778, lon: 103.364414 },
  { name: "D.I. Drien Bungong", lat: 5.212656, lon: 96.321779 },
  { name: "D.I.R. Lagan Hulu", lat: -1.272778, lon: 103.740833 },
  { name: "D.I. Kiran", lat: 5.217402, lon: 96.338826 },
  { name: "D.I. Kerpei", lat: 3.609122, lon: 98.380253 },
  { name: "D.I.R. Bram Itam", lat: -0.856389, lon: 103.415083 },
  { name: "D.I. Alue Punti", lat: 4.584097, lon: 95.906826 },
  { name: "D.I. Kuta Krueng", lat: 5.198919, lon: 96.334551 },
  { name: "D.I.R. Marga Mulya", lat: -1.212778, lon: 104.031667 },
  { name: "D.I. Meugit", lat: 5.196771, lon: 96.331502 },
  { name: "D.I.R. Kayu Aro Kanan", lat: -0.783611, lon: 103.136203 },
  { name: "D.I. Blang Jempeuk", lat: 4.619575, lon: 95.628988 },
  { name: "D.I. Ule Glee", lat: 5.163733, lon: 96.317603 },
  { name: "D.I.R. Rantau Rasau", lat: -1.210556, lon: 104.085833 },
  { name: "D.I. Ulim", lat: 5.209098, lon: 96.302273 },
  { name: "D.I. Kareung Ateuh", lat: 5.015148, lon: 95.388827 },
  { name: "D.I.R. Rantau Rasau Desa", lat: -1.199722, lon: 104.135556 },
  { name: "D.I. Krueng Nalan", lat: 5.170348, lon: 96.499458 },
  { name: "D.I. Paya Gulungku", lat: 5.190830, lon: 96.429028 },
  { name: "D.I. Pante Kuyun", lat: 4.773487, lon: 95.574792 },
  { name: "D.I. Rayeuk Mamplam", lat: 5.183998, lon: 96.414363 },
  { name: "D.I. Panga Pucok", lat: 4.553488, lon: 95.753268 },
  { name: "D.I. Lapang Timu", lat: 5.238155, lon: 96.900462 },
  { name: "D.I. Sogawu", lat: 1.448050, lon: 97.468518 },
  { name: "D.I. Namu Mbelin", lat: 3.535592, lon: 98.338531 },
  { name: "D.I. Cot Mane", lat: 5.226845, lon: 96.868515 },
  { name: "D.I. Samalanga", lat: 5.183021, lon: 96.358669 },
  { name: "D.I. Suak Lango", lat: 4.422719, lon: 96.301561 },
  { name: "D.I. Krueng Peudada", lat: 5.183689, lon: 96.624729 },
  { name: "D.I. Alue Peudeung", lat: 4.306529, lon: 96.216552 },
  { name: "D.I. Panton", lat: 5.153550, lon: 96.983157 },
  { name: "D.I. Tumpok Ladang", lat: 4.203275, lon: 96.164780 },
  { name: "D.I.R. Simpang Datuk", lat: -1.130849, lon: 104.301847 },
  { name: "D.I. Alue Grong-Grong", lat: 4.983462, lon: 97.711598 },
  { name: "D.I.R. Kayu Aro Kiri", lat: -0.798611, lon: 103.126500 },
  { name: "D.I. Drien Caleu", lat: 4.308056, lon: 96.226368 },
  { name: "D.I. Simulbas", lat: 1.977157, lon: 98.531520 },
  { name: "D.I.R. Simpang Puding", lat: -1.229444, lon: 104.084167 },
  { name: "D.I.R. Penganyut", lat: -1.280556, lon: 104.096111 },
  { name: "D.I. Rogas", lat: 1.979174, lon: 98.516755 },
  { name: "D.I.R. Kempas Jaya", lat: -0.795833, lon: 103.115472 },
  { name: "D.I. Sipodang", lat: 1.980033, lon: 98.525405 },
  { name: "D.I. Sihapas", lat: 1.966825, lon: 98.536728 },
  { name: "D.I. Sipaubat", lat: 2.024450, lon: 98.386720 },
  { name: "D.I.R. Margo Rukun", lat: -0.825278, lon: 103.069792 },
  { name: "D.I.R. Nipah Panjang", lat: -1.157222, lon: 104.188333 },
  { name: "D.I.R. Mekar Jati", lat: -0.809722, lon: 103.164622 },
  { name: "D.I.R. Dendang I - II", lat: -1.199167, lon: 103.994167 },
  { name: "D.I.R. Pasar Senin", lat: -0.828056, lon: 103.185283 },
  { name: "D.I. Meunasah Ara", lat: 4.218514, lon: 96.167679 },
  { name: "D.I. Meunasah Rayek I", lat: 4.220443, lon: 96.173728 },
  { name: "D.I.R. Koto Kandis", lat: -1.185833, lon: 104.026944 },
  { name: "D.I.R. Senyerang", lat: -0.820556, lon: 103.142383 },
  { name: "D.I. Pasie Teungoh", lat: 4.187348, lon: 96.165260 },
  { name: "D.I. Paya Lumpat", lat: 4.238445, lon: 96.078889 },
  { name: "D.I. Pinem", lat: 4.247935, lon: 96.057213 },
  { name: "D.I. Meurandeh", lat: 3.612905, lon: 96.940548 },
  { name: "D.I. Tangan-Tangan", lat: 3.646754, lon: 96.902069 },
  { name: "D.I. Abah Kala", lat: 5.528155, lon: 95.822973 },
  { name: "D.I. Binieb", lat: 5.430888, lon: 95.877572 },
  { name: "D.I. Blang Kubu", lat: 5.505511, lon: 95.825629 },
  { name: "D.I. Blang Laweung", lat: 5.502446, lon: 95.840547 },
  { name: "D.I. Gintong", lat: 5.373944, lon: 95.892058 },
  { name: "D.I.R. Secanggang", lat: 3.867400, lon: 98.531900 },
  { name: "D.I. Belimau", lat: -0.416919, lon: 117.177691 },
  { name: "D.I. Rantau Pakam", lat: 4.402304, lon: 98.208461 },
  { name: "D.I. Seunebok Bacee", lat: 4.421286, lon: 98.134256 },
  { name: "D.I.R. Lambur I - II", lat: -1.106389, lon: 103.973056 },
  { name: "D.I. Meureudu", lat: 5.253047, lon: 96.244100 },
  { name: "D.I.R. Pamusiran Luar", lat: -1.084167, lon: 104.127222 },
  { name: "D.I. Ie Rhob Timur", lat: 5.181547, lon: 96.397808 },
  { name: "D.I.R. Py. Lubuk Jawi", lat: -1.704167, lon: 103.179444 },
  { name: "D.I. Sungai Pulai", lat: -1.693889, lon: 103.064444 },
  { name: "D.I.R. Py. Rengas Condong", lat: -1.712500, lon: 103.270556 },
  { name: "D.I.R. Py. Senaning", lat: -1.570556, lon: 103.359444 },
  { name: "D.I.R. Py. Pematang Pacat", lat: -1.688611, lon: 103.113611 },
  { name: "D.I.R. Py. Pasar Terusan", lat: -1.706389, lon: 103.158333 },
  { name: "D.I.R. Py. Sei Duo", lat: -1.505556, lon: 103.420000 },
  { name: "D.I.R. Py. Tanjung Marwo", lat: -1.738889, lon: 103.105833 },
  { name: "D.I.R. Py. Sei Bayur", lat: -1.671389, lon: 102.920556 },
  { name: "D.I.R. Py. Sei Dimpang", lat: -1.673056, lon: 103.029722 },
  { name: "D.I.R. Py. Belakang Dusun", lat: -1.674167, lon: 102.943333 },
  { name: "D.I.R. Py. Lebar Sei Lais", lat: -1.682500, lon: 103.185556 },
  { name: "D.I.R. Py. Lebung Rimbo", lat: -1.675278, lon: 102.991944 },
  { name: "D.I.R. Py. Lubuk Ruso", lat: -1.548056, lon: 103.370000 },
  { name: "D.I.R. Py. Napal Sisik", lat: -1.686389, lon: 103.213056 },
  { name: "D.I.R. Py. Paku Aji", lat: -1.707778, lon: 103.115000 },
  { name: "D.I.R. Py. Pematang Temiang", lat: -1.893094, lon: 102.975221 },
  { name: "D.I.R. Py. Lubang", lat: -1.688611, lon: 103.083889 },
  { name: "D.I.R. Py. Sei Payung", lat: -1.670278, lon: 102.872778 },
  { name: "D.I.R. Py. Pelumpung", lat: -1.658333, lon: 103.007222 },
  { name: "D.I.R. Py. Saken Seberang", lat: -1.655278, lon: 102.851389 },
  { name: "D.I. Sei. Keluru", lat: -2.176944, lon: 101.505556 },
  { name: "D.I. Sei. Air Lingkat", lat: -2.229167, lon: 101.546111 },
  { name: "D.I. Sei. Talang Aro", lat: -2.258700, lon: 101.541000 },
  { name: "D.I. Batu Lumut", lat: -2.074167, lon: 101.407500 },
  { name: "D.I. Jembatan Serong", lat: -2.083889, lon: 101.425000 },
  { name: "D.I. Sei Bungkal", lat: -2.043937, lon: 101.389545 },
  { name: "D.I. Simpang III", lat: -2.045833, lon: 101.411667 },
  { name: "D.I.R. Pasir Putih", lat: -1.266944, lon: 103.802778 },
  { name: "D.I. Makroman", lat: -0.511604, lon: 117.250606 },
  { name: "D.I. Kutai Lama", lat: -0.575060, lon: 117.333900 },
  { name: "D.I.R. Sungai Rambut", lat: -1.230278, lon: 104.153889 },
  { name: "D.I.R. Simbur Naik", lat: -1.071667, lon: 103.972500 },
  { name: "D.I.R. Sungai Raya", lat: -0.833611, lon: 103.284081 },
  { name: "D.I. Kutai Lama", lat: -0.576163, lon: 117.332483 },
  { name: "D.I.R. Teluk Nilau", lat: -0.856389, lon: 103.244117 },
  { name: "D.I. Sidomulyo A", lat: -0.549790, lon: 117.268257 },
  { name: "D.I. Semangkok", lat: -0.121249, lon: 117.435674 },
  { name: "D.I.R. Sungai Tuak", lat: -1.915260, lon: 116.211427 },
  { name: "D.I.R. Suliliran", lat: -1.925452, lon: 116.255467 },
  { name: "D.I.R. Jone Rantau Panjang", lat: -1.840767, lon: 116.254996 },
  { name: "D.I. Sepaso Barat", lat: 0.755795, lon: 117.540050 },
  { name: "D.I.R. Telago Limo", lat: -1.263056, lon: 104.133333 },
  { name: "D.I.R. Sungai Palas", lat: -1.167778, lon: 104.197778 },
  { name: "D.I. Selangkau", lat: 0.839025, lon: 117.855731 },
  { name: "D.I.R. Py. Danau Embat", lat: -1.651111, lon: 103.175556 },
  { name: "D.I.R. Py. Bencah", lat: -1.653056, lon: 102.802778 },
  { name: "D.I.R. Py. Sei Aur", lat: -1.669444, lon: 103.170556 },
  { name: "D.I. Karmeo", lat: -1.796389, lon: 103.045833 },
  { name: "D.I.R. Py. Kacung", lat: -1.687778, lon: 103.303611 },
  { name: "D.I.R. Py. Lebar", lat: -1.654444, lon: 102.869444 },
  { name: "D.I.R. Py. Lebar Belakang Dusun", lat: -1.664167, lon: 102.778889 },
  { name: "D.I.R. Py. Lubuk Jeramun", lat: -1.695556, lon: 102.876667 },
  { name: "D.I.R. Py. Sei Lais II", lat: -1.691111, lon: 103.041667 },
  { name: "D.I.R. Py. Sei Lantang", lat: -1.704722, lon: 103.058333 },
  { name: "D.I.R. Py. Sei Napal", lat: -1.686944, lon: 103.003889 },
  { name: "D.I.R. Py. Sei Payung", lat: -1.670833, lon: 102.873056 },
  { name: "D.I.R. Py. Penghujan", lat: -1.491944, lon: 103.422500 },
  { name: "D.I.R. Py. Sei Pedak", lat: -1.675556, lon: 103.040000 },
  { name: "D.I.R. Py. Sei Rumbai", lat: -1.691944, lon: 103.044444 },
  { name: "D.I.R. Py. Tunggul Buto", lat: -1.847222, lon: 103.016111 },
  { name: "D.I.R. Kumpeh", lat: -1.410099, lon: 103.949868 },
  { name: "D.I.R. Niaso", lat: -1.539995, lon: 103.619127 },
  { name: "D.I.R. Senaung", lat: -1.551944, lon: 103.560556 },
  { name: "D.I.R. Sungai Rambai", lat: -0.852222, lon: 103.049722 },
  { name: "D.I.R. Teluk Ketapang", lat: -0.809722, lon: 103.107778 },
  { name: "D.I. Pagar Puding", lat: -1.368056, lon: 102.360833 },
  { name: "D.I.R. Rawa Jone", lat: -1.909330, lon: 116.249843 },
  { name: "D.I. Temiang Mali I", lat: 0.118042, lon: 110.078133 },
  { name: "D.I.R. Sungai Pinyuh Komplek", lat: 0.230857, lon: 109.112629 },
  { name: "D.I.R. Tebas sungai", lat: 1.202027, lon: 109.159984 },
  { name: "D.I. Sebandang", lat: -0.122557, lon: 110.111473 },
  { name: "D.I. Madong", lat: -0.843565, lon: 111.540924 },
  { name: "D.I.R. Tekarang Komplek", lat: 1.260324, lon: 109.122352 },
  { name: "D.I. Tambak Rawang", lat: -1.217111, lon: 109.933711 },
  { name: "D.I. Tolang", lat: 1.983700, lon: 98.514900 },
  { name: "D.I.R. Selakau Komplek", lat: 1.071978, lon: 109.025503 },
  { name: "D.I.R. Meranti Paham", lat: 2.384317, lon: 100.188150 },
  { name: "D.I.R. Sei Siarti", lat: 2.266880, lon: 100.230830 },
  { name: "D.I. Nalawo", lat: 0.907300, lon: 97.898000 },
  { name: "D.I. Laehuwa", lat: 1.456803, lon: 97.457767 },
  { name: "D.I.R. Dungun Laut", lat: 1.296721, lon: 109.038884 },
  { name: "D.I. Tanjung", lat: 0.089736, lon: 110.121144 },
  { name: "D.I.R. Penepat Komplek", lat: 0.192737, lon: 109.241036 },
  { name: "D.I.R. Purun Hulu", lat: 0.226560, lon: 109.153931 },
  { name: "D.I.R. Segedong", lat: 0.176003, lon: 109.173066 },
  { name: "D.I. Empirang Pokok I", lat: 0.152287, lon: 110.125556 },
  { name: "D.I.R. Siduk", lat: -1.348694, lon: 110.077900 },
  { name: "D.I.R. Sepinggan", lat: 1.131500, lon: 109.081400 },
  { name: "D.I. Kaubun", lat: 1.033041, lon: 117.848371 },
  { name: "D.I.R. Tebas Komplek", lat: 1.194254, lon: 109.145455 },
  { name: "D.I. Empu Engkiyang", lat: 0.171470, lon: 110.090432 },
  { name: "D.I.R. Purun Hulu", lat: 0.225427, lon: 109.152196 },
  { name: "D.I. Sebandang", lat: -0.122974, lon: 110.111594 },
  { name: "D.I.R. Sungai Paduan", lat: -1.011899, lon: 109.792826 },
  { name: "D.I.R. Samustida", lat: 1.567322, lon: 109.239240 },
  { name: "D.I. Tekang", lat: 0.091904, lon: 111.639442 },
  { name: "D.I. Dusun Petai", lat: 0.282105, lon: 109.636667 },
  { name: "D.I. Mungguk Pelancar", lat: -0.023653, lon: 110.954369 },
  { name: "D.I.R. Jawai Komplek", lat: 1.240266, lon: 109.049136 },
  { name: "D.I. Kenukut", lat: 0.065209, lon: 111.633352 },
  { name: "D.I. Mentubang", lat: -1.180640, lon: 109.942850 },
  { name: "D.I. Dusun Petai", lat: 0.282906, lon: 109.637069 },
  { name: "D.I. Sei Sualang", lat: -2.423889, lon: 102.271111 },
  { name: "D.I. Rawang Ujo", lat: -2.290556, lon: 102.737222 },
  { name: "D.I.R. Jawai Komplek", lat: 1.273286, lon: 109.035771 },
  { name: "D.I. Serang", lat: -0.067077, lon: 111.173579 },
  { name: "D.I. Dusun Petai", lat: 0.276896, lon: 109.636809 },
  { name: "D.I. Lirang", lat: 0.617710, lon: 109.399721 },
  { name: "D.I. Mawang", lat: -0.790934, lon: 111.582725 },
  { name: "D.I. Dano", lat: 0.550684, lon: 109.327302 },
  { name: "D.I. Duri", lat: -0.799049, lon: 111.601165 },
  { name: "D.I. Lancak", lat: 0.057296, lon: 110.071295 },
  { name: "D.I.R. Jungkat Komplek", lat: 0.081014, lon: 109.193083 },
  { name: "D.I. Suka Maju Luansara", lat: 0.809548, lon: 113.121646 },
  { name: "D.I.R. Semelagi Komplek", lat: 1.049922, lon: 109.001617 },
  { name: "D.I.R. Melapi Komplek", lat: 0.827202, lon: 112.971602 },
  { name: "D.I. Selalong I", lat: 0.014430, lon: 110.889953 },
  { name: "D.I. Sangku I", lat: 0.207710, lon: 109.999708 },
  { name: "D.I.R. Sungai Paduan", lat: -1.016014, lon: 109.799439 },
  { name: "D.I.R. Tanjung Baik Budi", lat: -1.482650, lon: 110.059861 },
  { name: "D.I.R. Kuala Satong", lat: -1.396038, lon: 110.081515 },
  { name: "D.I. Bagam", lat: 0.058056, lon: 110.909444 },
  { name: "D.I. Setor Karya Sp.5", lat: 0.218050, lon: 110.956367 },
  { name: "D.I. Landau Kodah I", lat: 0.120006, lon: 110.915618 },
  { name: "D.I. Semabi", lat: 0.104200, lon: 110.867400 },
  { name: "D.I. Nanga Pemubuh", lat: -0.109567, lon: 111.056775 },
  { name: "D.I. Setawar", lat: -0.131150, lon: 110.999246 },
  { name: "D.I.R. Sungai Puteri", lat: -1.620096, lon: 110.041155 },
  { name: "D.I.R. Kuala Tolak", lat: -1.442556, lon: 110.068940 },
  { name: "D.I. Mawan", lat: 0.486455, lon: 112.362723 },
  { name: "D.I. Nanga Nyabau", lat: 1.014193, lon: 112.704878 },
  { name: "D.I. Lumut", lat: -0.180008, lon: 110.073059 },
  { name: "D.I. Lanso", lat: 0.355879, lon: 109.642993 },
  { name: "D.I. Empirang Ujung", lat: 0.182310, lon: 110.135668 },
  { name: "d.i. Manjang", lat: -0.204268, lon: 110.879511 },
  { name: "D.I. Senyabang", lat: 0.189030, lon: 110.171071 },
  { name: "D.I. Angkaras", lat: 0.592765, lon: 109.606040 },
  { name: "D.I. Sum Sum", lat: 0.319617, lon: 109.470557 },
  { name: "D.I. Napal", lat: 0.602179, lon: 109.385610 },
  { name: "D.I. Pak Liung", lat: 0.134481, lon: 109.585671 },
  { name: "D.I. Mamek Mandor", lat: 0.313083, lon: 109.449549 },
  { name: "D.I. Kayu Ara Jelimpo", lat: 0.292847, lon: 110.086921 },
  { name: "D.I. Bagak", lat: 0.552098, lon: 109.695197 },
  { name: "D.I. Simpang Pana", lat: 0.331571, lon: 109.469232 },
  { name: "D.I. Jelayan Semade Hilir", lat: 0.728190, lon: 109.481170 },
  { name: "D.I. Ringo Hilir", lat: 0.616130, lon: 109.552503 },
  { name: "D.I. Emparu", lat: 0.078888, lon: 111.824516 },
  { name: "D.I. Kebong", lat: 0.057606, lon: 111.648000 },
  { name: "D.I. Manter", lat: -0.073628, lon: 111.489584 },
  { name: "D.I. Bukit Kelam", lat: 0.092149, lon: 111.670843 }
  ];

  var userMarker, routeLayer;

  function setUserLocation(lat, lon) {
    if (userMarker) map.removeLayer(userMarker);
    userMarker = L.marker([lat, lon], {color: 'blue'}).addTo(map)
      .bindPopup("Lokasi Anda").openPopup()
      .bindTooltip("Lokasi Anda", {permanent: true, direction: "top"});
  }

  function locateUser() {
    if (navigator.geolocation) {
      navigator.geolocation.getCurrentPosition(function(pos) {
        var lat = pos.coords.latitude;
        var lon = pos.coords.longitude;
        map.setView([lat, lon], 14);
        setUserLocation(lat, lon);
      }, function(err) {
        alert("Tidak bisa ambil lokasi: " + err.message);
      });
    } else {
      alert("Browser tidak mendukung Geolocation.");
    }
  }

  // Ambil lokasi saat load pertama
  locateUser();

  // Control tombol "Show My Location"
  var locateControl = L.control({ position: 'topleft' });
  locateControl.onAdd = function () {
    var div = L.DomUtil.create('div', 'leaflet-control-locate');
    div.innerHTML = "üìç My Location";
    div.onclick = function(){
      locateUser();
    };
    return div;
  };
  locateControl.addTo(map);

  // Klik peta untuk set lokasi manual
  map.on('click', function(e) {
    setUserLocation(e.latlng.lat, e.latlng.lng);
  });

  // Marker tujuan + label
  destinations.forEach(function(dest) {
    var popupContent = "<b>" + dest.name + "</b><br>" +
      "<button class='route-btn' onclick='getRoute(" + dest.lat + "," + dest.lon + ")'>Rute ke sini</button>";
    L.marker([dest.lat, dest.lon]).addTo(map)
      .bindPopup(popupContent)
      .bindTooltip(dest.name, {permanent: true, direction: "top"});
  });

  function getRoute(destLat, destLon) {
    if (!userMarker) {
      alert("Tentukan lokasi Anda terlebih dahulu (otomatis atau klik peta).");
      return;
    }

    var start = userMarker.getLatLng();
    var url = `https://api.openrouteservice.org/v2/directions/driving-car?api_key=${orsApiKey}&start=${start.lng},${start.lat}&end=${destLon},${destLat}`;

    fetch(url)
      .then(response => response.json())
      .then(data => {
        if (routeLayer) map.removeLayer(routeLayer);
        var coords = data.features[0].geometry.coordinates;
        var latlngs = coords.map(c => [c[1], c[0]]);
        routeLayer = L.polyline(latlngs, {color: 'blue'}).addTo(map);
        map.fitBounds(routeLayer.getBounds());
      })
      .catch(err => console.error(err));
  }
</script>

</body>
</html>

